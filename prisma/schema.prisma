generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "rhel-openssl-1.0.x", "rhel-openssl-3.0.x"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id           String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name         String        @db.VarChar(255)
  email        String        @unique @db.VarChar(255)
  password     String        @db.VarChar(255)
  phone_number String?       @db.VarChar(20)
  access_token String?
  created_at   DateTime?     @default(now()) @db.Timestamptz(6)
  updated_at   DateTime?     @default(now()) @updatedAt @db.Timestamptz(6)
  drugPatients DrugPatient[]
  profile      Profile[]
  transactions Transaction[]
  userRoles    UserRole[]

  @@map("users")
}

model Role {
  id          String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name        String     @unique @db.VarChar(50)
  description String?
  created_at  DateTime?  @default(now()) @db.Timestamptz(6)
  updated_at  DateTime?  @default(now()) @updatedAt @db.Timestamptz(6)
  userRoles   UserRole[]

  @@map("roles")
}

model UserRole {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id    String?   @db.Uuid
  role_id    String?   @db.Uuid
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  updated_at DateTime? @default(now()) @updatedAt @db.Timestamptz(6)
  role       Role?     @relation(fields: [role_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  user       User?     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, role_id])
  @@map("user_roles")
}

model Profile {
  id                    String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id               String?   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name                  String?   @default("128") @db.VarChar
  place_of_birth        String?   @default("64") @db.VarChar
  date_of_birth         DateTime? @db.Date
  gender                Int?      @default(1) @db.SmallInt
  card_number           String?   @default("32") @db.VarChar
  address               String?   @default("128") @db.VarChar
  rt                    Int?      @default(2) @db.SmallInt
  rw                    Int?      @default(2) @db.SmallInt
  city_id               String?   @default("16") @db.VarChar
  postal_code           Int?
  responsible_for_costs String?   @default("64") @db.VarChar
  blood_group           String?   @default("2") @db.VarChar
  created_at            DateTime  @default(now()) @db.Timestamptz(6)
  updated_at            DateTime? @default(now()) @updatedAt @db.Timestamp(6)
  user                  User?     @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@map("profiles")
}

model Clinic {
  id            String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name          String?       @default("64") @db.VarChar
  address       String?       @default("255") @db.VarChar
  accreditation String?       @default("2") @db.VarChar
  contact_name  String?       @default("64") @db.VarChar
  contact_phone String?       @default("24") @db.VarChar
  contact_email String?       @default("255") @db.VarChar
  created_at    DateTime      @default(now()) @db.Timestamptz(6)
  updated_at    DateTime?     @default(now()) @updatedAt @db.Timestamp(6)
  appointments  Appointment[]
  doctors       Doctor[]
  polies        Poly[]

  @@map("clinics")
}

model Poly {
  id            String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name          String?        @default("128") @db.VarChar
  description   String?
  status        Int?           @default(1) @db.SmallInt
  created_at    DateTime       @default(now()) @db.Timestamptz(6)
  updated_at    DateTime?      @default(now()) @updatedAt @db.Timestamp(6)
  clinic_id     String?        @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  appointments  Appointment[]
  doctors       Doctor[]
  clinic        Clinic?        @relation(fields: [clinic_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  scheduleDates ScheduleDate[]
  symptoms      Symptom[]

  @@map("polies")
}

model Doctor {
  id            String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  degree        String?        @default("64") @db.VarChar
  description   String?
  clinic_id     String?        @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  poly_id       String?        @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  status        Int?           @default(1) @db.SmallInt
  created_at    DateTime       @default(now()) @db.Timestamptz(6)
  updated_at    DateTime?      @default(now()) @updatedAt @db.Timestamp(6)
  specialize    String?        @default("64") @db.VarChar
  user_id       String?        @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name          String?        @db.VarChar
  appointments  Appointment[]
  clinic        Clinic?        @relation(fields: [clinic_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  poly          Poly?          @relation(fields: [poly_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  scheduleDates ScheduleDate[]

  @@map("doctors")
}

model ScheduleDate {
  id            String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  poly_id       String?        @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  doctor_id     String?        @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  schedule_date DateTime?      @db.Date
  created_at    DateTime       @default(now()) @db.Timestamptz(6)
  updated_at    DateTime?      @default(now()) @updatedAt @db.Timestamp(6)
  appointments  Appointment[]
  doctor        Doctor?        @relation(fields: [doctor_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  poly          Poly?          @relation(fields: [poly_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  scheduleTimes ScheduleTime[]

  @@map("schedule_dates")
}

model ScheduleTime {
  id            String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  date_id       String?       @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  schedule_time String?       @default("64") @db.VarChar
  created_at    DateTime      @default(now()) @db.Timestamptz(6)
  updated_at    DateTime?     @default(now()) @updatedAt @db.Timestamp(6)
  limit         Int?
  appointments  Appointment[]
  date          ScheduleDate? @relation(fields: [date_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@map("schedule_times")
}

model Appointment {
  id                  String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id             String?           @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  clinic_id           String?           @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  poly_id             String?           @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  doctor_id           String?           @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  date_id             String?           @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  time_id             String?           @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  status              Int?              @default(1) @db.SmallInt
  rejected_note       String?           @default("255") @db.VarChar
  created_at          DateTime          @default(now()) @db.Timestamptz(6)
  updated_at          DateTime?         @default(now()) @updatedAt @db.Timestamp(6)
  qr_code             String?           @default("8") @db.VarChar
  symptoms            String?
  symptom_description String?
  ai_response         String?
  appointmentDrugs    AppointmentDrug[]
  appointmentFees     AppointmentFee[]
  clinic              Clinic?           @relation(fields: [clinic_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  date                ScheduleDate?     @relation(fields: [date_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  doctor              Doctor?           @relation(fields: [doctor_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  poly                Poly?             @relation(fields: [poly_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  time                ScheduleTime?     @relation(fields: [time_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  transactions        Transaction[]

  @@map("appointments")
}

model Drug {
  id               String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name             String?           @default("128") @db.VarChar
  description      String?
  company_name     String?           @default("255") @db.VarChar
  stock         Int?              @default(0) // Stock biasanya cukup pakai Int
  buy_price     Decimal?          @db.Decimal(15, 2)
  sell_price    Decimal?
  dosis            String?           @default("16") @db.VarChar
  kind             String?           @default("32") @db.VarChar
  is_halal         Boolean?
  created_at       DateTime          @default(now()) @db.Timestamptz(6)
  updated_at       DateTime?         @default(now()) @updatedAt @db.Timestamp(6)
  appointmentDrugs AppointmentDrug[]
  drugPatients     DrugPatient[]

  @@map("drugs")
}

model AppointmentDrug {
  id             String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  appointment_id String?      @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  drug_id        String?      @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  status         Boolean?
  created_at     DateTime     @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?    @default(now()) @updatedAt @db.Timestamp(6)
  price           Decimal?
  grab_status    Int?         @default(1) @db.SmallInt
  grab_date      DateTime?    @db.Timestamp(6)
  appointment    Appointment? @relation(fields: [appointment_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  drug           Drug?        @relation(fields: [drug_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@map("appointment_drugs")
}

model Fee {
  id              String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  procedure       String?          @db.VarChar
  price           Decimal?
  status          Boolean?         @default(false)
  created_at      DateTime         @default(now()) @db.Timestamptz(6)
  updated_at      DateTime?        @updatedAt @db.Timestamp(6)
  clinic_id       String?          @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  appointmentFees AppointmentFee[]

  @@map("fees")
}

model AppointmentFee {
  id             String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  appointment_id String?      @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  fee_id         String?      @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  status         Boolean?
  created_at     DateTime     @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?    @default(now()) @updatedAt @db.Timestamp(6)
  price          BigInt?
  appointment    Appointment? @relation(fields: [appointment_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  fee            Fee?         @relation(fields: [fee_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@map("appointment_fees")
}

model Transaction {
  id                 String      @id @db.Uuid
  bank_id            String      @db.Uuid
  appointment_id     String      @db.Uuid
  user_id            String      @db.Uuid
  transaction_number String      @db.VarChar(255)
  total_price        Decimal     @db.Decimal(15, 2)
  created_at         DateTime?   @db.Timestamptz(6)
  updated_at         DateTime?   @db.Timestamptz(6)
  status             Int?
  appointment        Appointment @relation(fields: [appointment_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_appointment_id")
  bank               Bank        @relation(fields: [bank_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_bank_id")
  user               User        @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_user_id")

  @@map("transactions")
}

model Bank {
  id             String        @id @db.Uuid
  name           String        @db.VarChar(255)
  account_number String?       @db.VarChar(255)
  created_at     DateTime?     @db.Timestamptz(6)
  updated_at     DateTime?     @db.Timestamptz(6)
  transactions   Transaction[]

  @@map("banks")
}

model DrugPatient {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id      String?   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  drug_id      String?   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  created_at   DateTime  @default(now()) @db.Timestamptz(6)
  updated_at   DateTime? @default(now()) @updatedAt @db.Timestamp(6)
  description  String?   @default("255") @db.VarChar
  consume_time String?   @db.VarChar
  many_per_day Int?      @db.SmallInt
  drug         Drug?     @relation(fields: [drug_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user         User?     @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@map("drug_patients")
}

model Notification {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  type         Int?      @db.SmallInt
  user_id_from String?   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id_to   String?   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  page_link    String?   @default("") @db.VarChar
  message      String?
  status       Boolean?  @default(false)
  created_at   DateTime  @default(now()) @db.Timestamptz(6)
  updated_at   DateTime? @default(now()) @updatedAt @db.Timestamp(6)

  @@map("notifications")
}

model Symptom {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  poly_id    String?   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  en_name    String?   @default("32") @db.VarChar
  id_name    String?   @default("32") @db.VarChar
  created_at DateTime  @default(now()) @db.Timestamptz(6)
  updated_at DateTime? @default(now()) @updatedAt @db.Timestamp(6)
  poly       Poly?     @relation(fields: [poly_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@map("symptoms")
}

model About {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  id_body    String?
  updated_at DateTime? @default(now()) @updatedAt @db.Timestamp(6)
  created_at DateTime  @default(now()) @db.Timestamptz(6)
  en_body    String?

  @@map("abouts")
}

model AiApi {
  id               String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  api_model        String?   @db.VarChar
  api_key          String?   @db.VarChar
  max_tokens_limit Int?   @default(900000)
  created_at       DateTime  @default(now()) @db.Timestamptz(6)
  updated_at       DateTime? @default(now()) @updatedAt @db.Timestamp(6)
  status           Boolean?

  @@map("ai_apis")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model City {
  id           String  @default("16") @db.VarChar
  province     String  @default("128") @db.VarChar
  district     String? @default("128") @db.VarChar
  sub_district String? @default("128") @db.VarChar
  village      String? @default("128") @db.VarChar

  @@map("cities")
  @@ignore
}

model Faq {
  id             String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  en_title       String?   @default("255") @db.VarChar
  en_description String?
  id_title       String?   @default("255") @db.VarChar
  id_description String?
  created_at     DateTime  @default(now()) @db.Timestamptz(6)
  updated_at     DateTime? @default(now()) @updatedAt @db.Timestamp(6)

  @@map("faqs")
}

model File {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  module_class String    @db.VarChar
  module_id    String    @db.Uuid
  file_name    String    @db.VarChar
  file_type    String    @db.VarChar
  created_at   DateTime? @default(now()) @db.Timestamptz(6)
  updated_at   DateTime? @default(now()) @updatedAt @db.Timestamptz(6)

  @@map("files")
}

model HelpCenter {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  en_summary String?
  en_note    String?   @default("255") @db.VarChar
  en_contact String?   @default("255") @db.VarChar
  id_summary String?
  id_note    String?   @default("255") @db.VarChar
  id_contact String?   @default("255") @db.VarChar
  created_at DateTime  @default(now()) @db.Timestamptz(6)
  updated_at DateTime? @default(now()) @updatedAt @db.Timestamp(6)

  @@map("help_centers")
}
